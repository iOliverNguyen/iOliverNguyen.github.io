<!doctype html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>TIL: String type with a specific length in TypeScript | Oliver Nguyen</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="all,follow"><meta name="googlebot" content="index,follow,snippet,archive"><meta name="og:site_name" content="Oliver Nguyen"><meta property="og:title" content="TIL: String type with a specific length in TypeScript"><meta property="og:description" content="We&rsquo;ll declare a Phantom Type:
type StringN&lt;N&gt; = string &amp; { length: N; readonly X: unique symbol; } const isStringN = &lt;N extends number&gt;(length: N, s: string): s is StringN&lt;N&gt; =&gt; s.length == length; export const stringN = &lt;N extends number&gt;(length: N, s: string): StringN&lt;N&gt; =&gt; { if (!isStringN(length, s)) throw new Error(`input must have length ${length}`); return s; } Then we can use it as below:
export type MicroUuid = StringN&lt;4&gt;; export const microUuid = () =&gt; stringN(4, newUuid()."><meta property="og:type" content="article"><meta property="og:url" content="https://iOliverNguyen.github.io/w/microuuid/"><meta property="og:image" content="https://iOliverNguyen.github.io/images/ogx.png"><meta property="article:section" content="w"><meta property="article:published_time" content="2023-08-26T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-26T00:00:00+00:00"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://iOliverNguyen.github.io/images/ogx.png"><meta name="twitter:title" content="TIL: String type with a specific length in TypeScript"><meta name="twitter:description" content="We&rsquo;ll declare a Phantom Type:
type StringN&lt;N&gt; = string &amp; { length: N; readonly X: unique symbol; } const isStringN = &lt;N extends number&gt;(length: N, s: string): s is StringN&lt;N&gt; =&gt; s.length == length; export const stringN = &lt;N extends number&gt;(length: N, s: string): StringN&lt;N&gt; =&gt; { if (!isStringN(length, s)) throw new Error(`input must have length ${length}`); return s; } Then we can use it as below:
export type MicroUuid = StringN&lt;4&gt;; export const microUuid = () =&gt; stringN(4, newUuid()."><link rel="stylesheet" href="https://iOliverNguyen.github.io/css/style-classic.css"><link rel="stylesheet" href="https://iOliverNguyen.github.io/style.css"><link rel="icon" type="image/png" href="/images/favicon.png"><link href="https://iOliverNguyen.github.io/w/microuuid/index.xml" rel="alternate" type="application/rss+xml" title="Oliver Nguyen"><script async src="https://www.googletagmanager.com/gtag/js?id=G-L5X8RJDCLM"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-L5X8RJDCLM")</script><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">TIL: String type with a specific length in TypeScript</h1><div class="meta"><div class="postdate"><time datetime="2023-08-26 00:00:00 &#43;0000 UTC" itemprop="datePublished">2023-08-26</time></div><div class="article-tag">&nbsp;Â· <a class="tag-link" href="/w/#js" rel="tag">js</a></div></div></header><div class="content" itemprop="articleBody"><p>We&rsquo;ll declare a Phantom Type:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="kr">type</span> <span class="nx">StringN</span><span class="p">&lt;</span><span class="nt">N</span><span class="p">&gt;</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="nx">length</span>: <span class="kt">N</span><span class="p">;</span>
  <span class="kr">readonly</span> <span class="nx">X</span>: <span class="kt">unique</span> <span class="kt">symbol</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">isStringN</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">N</span> <span class="na">extends</span> <span class="na">number</span><span class="p">&gt;(</span><span class="nx">length</span>: <span class="kt">N</span><span class="p">,</span> <span class="nx">s</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span>
  <span class="nx">s</span> <span class="k">is</span> <span class="nx">StringN</span><span class="p">&lt;</span><span class="nt">N</span><span class="p">&gt;</span> <span class="o">=&gt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="nx">length</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">stringN</span> <span class="o">=</span> <span class="p">&lt;</span><span class="nt">N</span> <span class="na">extends</span> <span class="na">number</span><span class="p">&gt;(</span><span class="nx">length</span>: <span class="kt">N</span><span class="p">,</span> <span class="nx">s</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="nx">StringN</span><span class="p">&lt;</span><span class="nt">N</span><span class="p">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isStringN</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">s</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`input must have length </span><span class="si">${</span><span class="nx">length</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>Then we can use it as below:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="kr">export</span> <span class="kr">type</span> <span class="nx">MicroUuid</span> <span class="o">=</span> <span class="nx">StringN</span><span class="p">&lt;</span><span class="nt">4</span><span class="p">&gt;;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">microUuid</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">stringN</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nx">newUuid</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="kr">as</span> <span class="nx">MicroUuid</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">s4</span>: <span class="kt">MicroUuid</span>  <span class="o">=</span> <span class="nx">microUuid</span><span class="p">();</span>     
<span class="kd">let</span> <span class="nx">s5</span>: <span class="kt">StringN</span><span class="p">&lt;</span><span class="nt">5</span><span class="p">&gt;</span> <span class="o">=</span> <span class="nx">stringN</span><span class="p">&lt;</span><span class="nt">5</span><span class="p">&gt;(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">);</span>

<span class="nx">s4</span> <span class="o">=</span> <span class="s1">&#39;any string&#39;</span><span class="p">;</span> <span class="c1">// invalid
</span><span class="c1"></span><span class="nx">s4</span> <span class="o">=</span> <span class="nx">s5</span><span class="p">;</span>           <span class="c1">// invalid
</span></code></pre></div><p>We can extend it further to make a specific type for our MicroUuid:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="kr">type</span> <span class="nx">MicroUuid</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">&amp;</span> <span class="p">{</span>
  <span class="kr">readonly</span> <span class="nx">X</span>: <span class="kt">unique</span> <span class="kt">symbol</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">isMicroUuid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span>: <span class="kt">string</span><span class="p">)</span><span class="o">:</span> <span class="nx">s</span> <span class="k">is</span> <span class="nx">MicroUuid</span> <span class="o">=&gt;</span> <span class="sr">/[a-f0-9]{4}/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">asMicroUuid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span>: <span class="kt">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isMicroUuid</span><span class="p">(</span><span class="nx">s</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;invalid input&#39;</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">newMicroUuid</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">newUuid</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="kr">as</span> <span class="nx">MicroUuid</span><span class="p">;</span>
</code></pre></div><p>We can use the same declaration <code>readonly X: unique symbol</code> in multiple type, and they are still different:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="kd">let</span> <span class="nx">s5</span> <span class="o">=</span> <span class="nx">stringN</span><span class="p">&lt;</span><span class="nt">5</span><span class="p">&gt;(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">id</span>: <span class="kt">MicroUuid</span> <span class="o">=</span> <span class="nx">s5</span><span class="p">;</span>          <span class="c1">// invalid
</span></code></pre></div><p>And another trick: <a href="https://spin.atomicobject.com/2018/01/15/typescript-flexible-nominal-typing/">Flavoring: Flexible Nominal Typing for TypeScript</a>.</p><h2 id="author">Author</h2><p>I'm Oliver Nguyen. A software maker working mostly in Go and JavaScript. I enjoy learning and seeing a better version of myself each day. Occasionally spin off new open source projects. Share knowledge and thoughts during my journey. <span>Connect with me on <a class="icon" target="_blank" rel="noopener" href="https://github.com/iOliverNguyen"><i class="fab fa-github"></i> </a>, <a class="icon" target="_blank" rel="noopener" href="https://linkedin.com/in/iOliverNguyen"><i class="fab fa-linkedin"></i> </a>, <a class="icon" target="_blank" rel="noopener" href="https://x.com/_OliverNguyen"><i class="fab fa-twitter"></i> </a>, <a class="icon" target="_blank" rel="noopener" href="https://iOliverNguyen.medium.com"><i class="fab fa-medium-m"></i> </a>and <a class="icon" target="_blank" rel="noopener" href="mailto:iOliverNguyen@gmail.com"><i class="fas fa-envelope"></i> </a>.</span></p></div></article><div id="header-post"><a id="menu-icon" href="/w"><i class="fas fa-chevron-left fa-lg"></i> <span class="icon-text">Back</span></a> <a id="menu-icon-tablet" href="/w"><i class="fas fa-chevron-left fa-lg"></i> <span class="icon-text">Back</span></a></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul></ul></div><div id="toc-footer" class="tog-footer" style="display:none"><script>console.log("content",'<nav id="TableOfContents"></nav>')</script><div class="toc-header"><a href="#">TIL: String type with a specific length in TypeScript</a></div><nav id="TableOfContents"></nav></div><div id="share-footer" class="tog-footer" style="display:none"><ul><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fmicrouuid%2f&title=TIL%3a%20String%20type%20with%20a%20specific%20length%20in%20TypeScript"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fmicrouuid%2f"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://x.com/share?url=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fmicrouuid%2f&text=TIL%3a%20String%20type%20with%20a%20specific%20length%20in%20TypeScript"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fmicrouuid%2f&title=TIL%3a%20String%20type%20with%20a%20specific%20length%20in%20TypeScript"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fmicrouuid%2f&t=TIL%3a%20String%20type%20with%20a%20specific%20length%20in%20TypeScript"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="home" class="icon" href="/w"><i class="fas fa-chevron-left fa-lg" aria-hidden="true"></i> Back</a> <a id="toc" class="icon" href="#" onclick='return $(".tog-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $(".tog-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2024 Oliver Nguyen.</div><div class="footer-right"><nav><ul></ul></nav></div></footer></div></body><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script src="/lib/jquery/jquery.min.js"></script><script src="/js/main.js"></script></html>