<!doctype html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>ezpkg.io - Collection of packages to make writing Go code easier | Oliver Nguyen</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="all,follow"><meta name="googlebot" content="index,follow,snippet,archive"><meta name="og:site_name" content="Oliver Nguyen"><meta property="og:title" content="ezpkg.io - Collection of packages to make writing Go code easier"><meta property="og:description" content="As I work on various Go projects, I often find myself creating utility functions, extending existing packages, or developing packages to solve specific problems. Moving from one project to another, I usually have to copy or rewrite these solutions. So I created ezpkg.io to have all these utilities and packages in one place. Hopefully, you&rsquo;ll find them useful as well.

The logo is Gopherz - which I created using DALL-E  Let&rsquo;s look at some problems that these packages are solving."><meta property="og:type" content="article"><meta property="og:url" content="https://iOliverNguyen.github.io/w/ezpkg/"><meta property="og:image" content="https://iOliverNguyen.github.io/w/ezpkg/cover.png"><meta property="article:section" content="w"><meta property="article:published_time" content="2024-06-26T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-26T00:00:00+00:00"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://iOliverNguyen.github.io/w/ezpkg/cover.png"><meta name="twitter:title" content="ezpkg.io - Collection of packages to make writing Go code easier"><meta name="twitter:description" content="As I work on various Go projects, I often find myself creating utility functions, extending existing packages, or developing packages to solve specific problems. Moving from one project to another, I usually have to copy or rewrite these solutions. So I created ezpkg.io to have all these utilities and packages in one place. Hopefully, you&rsquo;ll find them useful as well.

The logo is Gopherz - which I created using DALL-E  Let&rsquo;s look at some problems that these packages are solving."><link rel="stylesheet" href="https://iOliverNguyen.github.io/css/style-classic.css"><link rel="stylesheet" href="https://iOliverNguyen.github.io/style.css"><link rel="icon" type="image/png" href="/images/favicon.png"><link href="https://iOliverNguyen.github.io/w/ezpkg/index.xml" rel="alternate" type="application/rss+xml" title="Oliver Nguyen"><script async src="https://www.googletagmanager.com/gtag/js?id=G-L5X8RJDCLM"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-L5X8RJDCLM")</script><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">ezpkg.io - Collection of packages to make writing Go code easier</h1><div class="meta"><div class="postdate"><time datetime="2024-06-26 00:00:00 &#43;0000 UTC" itemprop="datePublished">2024-06-26</time></div><div class="article-tag">&nbsp;Â· <a class="tag-link" href="/w/#go" rel="tag">go</a></div></div></header><div class="content" itemprop="articleBody"><p><em>As I work on various Go projects, I often find myself creating utility functions, extending existing packages, or developing packages to solve specific problems. Moving from one project to another, I usually have to copy or rewrite these solutions. So I created <a href="https://ezpkg.io">ezpkg.io</a> to have all these utilities and packages in one place. Hopefully, you&rsquo;ll find them useful as well.</em></p><div align="center"><p><a href="https://ezpkg.io"><img src="cover.svg" alt="gopherz"></a></p><i align="center">The logo is Gopherz - which I created using DALL-E</i></div><p>Let&rsquo;s look at some problems that these packages are solving.</p><hr><h2 id="handling-errors-in-functions-that-always-return-nil-errors">Handling errors in functions that always return nil errors</h2><p>For example, let&rsquo;s look at the following function using <a href="https://pkg.go.dev/strings#Builder"><code>strings.Builder</code></a> from the standard library:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="s">&#34;fmt&#34;</span>
<span class="kn">import</span> <span class="s">&#34;strings&#34;</span>

<span class="kd">func</span> <span class="nx">SliceToString1</span><span class="p">[</span><span class="nx">T</span> <span class="nx">any</span><span class="p">](</span><span class="nx">slice</span> <span class="p">[]</span><span class="nx">T</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">slice</span> <span class="p">{</span>
        <span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprint</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nf">String</span><span class="p">()</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">SliceToString2</span><span class="p">[</span><span class="nx">T</span> <span class="nx">any</span><span class="p">](</span><span class="nx">slice</span> <span class="p">[]</span><span class="nx">T</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">slice</span> <span class="p">{</span>
        <span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprint</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="nx">err</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nf">String</span><span class="p">(),</span> <span class="kc">nil</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">SliceToString3</span><span class="p">[</span><span class="nx">T</span> <span class="nx">any</span><span class="p">](</span><span class="nx">slice</span> <span class="p">[]</span><span class="nx">T</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">slice</span> <span class="p">{</span>
        <span class="nx">_</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprint</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span> <span class="c1">//nolint:errcheck
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nf">String</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>In <code>SliceToString1</code>, we add a panic check even though <code>strings.Builder</code> will always return nil error. In <code>SliceToString2</code>, we <em>correctly</em> handle the returned error by making the caller worry about checking an error <em>that never occurs</em>! In <code>SliceToString3</code>, we skip the check because the errors are nil anyway, but we still need to add <code>_, _ =</code> to make the IDE happy and <code>//nolint:errcheck</code> because our company blocks merging any PR that does not pass the <a href="https://github.com/golangci/golangci-lint">golint CI check</a>.</p><p>Another way, we could create our utility functions to simplify the code, then copy or write those <code>fprint</code> and <code>must</code> from <a href="https://github.com/search?q=must+language%3AGo+symbol%3Amust&amp;type=code">package to package</a> and <a href="https://github.com/a8m/rql/blob/78b5dd12a61227ae2e5fb84f325873b96f91db08/rql.go#L497">project</a> to <a href="https://github.com/dustin/go-heatmap/blob/b89dbd73785a2348b5e0558f719f27a826987ceb/kml.go#L55">project</a>:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nx">SliceToString4</span><span class="p">[</span><span class="nx">T</span> <span class="nx">any</span><span class="p">](</span><span class="nx">slice</span> <span class="p">[]</span><span class="nx">T</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">slice</span> <span class="p">{</span>
        <span class="nf">fprint</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nf">String</span><span class="p">()</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nf">fprint</span><span class="p">(</span><span class="nx">w</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Writer</span><span class="p">,</span> <span class="nx">v</span> <span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">must</span><span class="p">(</span><span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">v</span><span class="p">))</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">must</span><span class="p">[</span><span class="nx">T</span> <span class="nx">any</span><span class="p">](</span><span class="nx">v</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="nx">T</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">v</span>
<span class="p">}</span>
</code></pre></div><h3 id="import-ezpkgiostringz">Import &ldquo;ezpkg.io/stringz&rdquo;</h3><p>Here is how the example is rewritten with <a href="https://ezpkg.io/stringz">ezpkg.io/stringz</a> using <a href="https://pkg.go.dev/ezpkg.io/stringz#Builder"><code>stringz.Builder</code></a>:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="s">&#34;ezpkg.io/stringz&#34;</span>

<span class="kd">func</span> <span class="nx">SliceToString</span><span class="p">[</span><span class="nx">T</span> <span class="nx">any</span><span class="p">](</span><span class="nx">slice</span> <span class="p">[]</span><span class="nx">T</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="nx">stringz</span><span class="p">.</span><span class="nx">Builder</span> <span class="c1">// change to stringz
</span><span class="c1"></span>    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">slice</span> <span class="p">{</span>
        <span class="nx">b</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>        <span class="c1">// look ma, no error!ðŸ”¥
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nf">String</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>Other examples include <a href="https://pkg.go.dev/ezpkg.io/bytez#Buffer"><code>bytez.Buffer</code></a> and <a href="https://pkg.go.dev/ezpkg.io/fmtz#State"><code>fmtz.State</code></a>. They <a href="https://github.com/ezpkg/ezpkg/blob/main/fmtz/state_test.go#L13-L17">share the same interface</a> and include various methods that are ready to use. Let&rsquo;s look at <a href="https://pkg.go.dev/ezpkg.io/stringz#Builder.WriteString"><code>WriteString</code></a> and its variant <a href="https://pkg.go.dev/ezpkg.io/stringz#Builder.WriteStringZ"><code>WriteStringZ</code></a>:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">stringz</span> <span class="c1">// import &#34;ezpkg.io/stringz&#34;
</span><span class="c1"></span>
<span class="kd">type</span> <span class="nx">Builder</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder</span><span class="p">)</span> <span class="nf">unwrap</span><span class="p">()</span> <span class="o">*</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span><span class="p">)(</span><span class="nx">b</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder</span><span class="p">)</span> <span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nf">unwrap</span><span class="p">().</span><span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">Builder</span><span class="p">)</span> <span class="nf">WriteStringZ</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="nx">n</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">b</span><span class="p">.</span><span class="nf">unwrap</span><span class="p">().</span><span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">n</span>
<span class="p">}</span>
</code></pre></div><p>The <code>WriteString</code> method exposes the original method and keeps the same signature, while the <code>WriteStringZ</code> variant eliminates the need for handling errors. Writing Go code is <em>ea<strong>z</strong>ier</em> now!ðŸ¥°</p><hr><h2 id="sometimes-we-just-want-to-skip-all-the-errors-to-quickly-write-a-simple-cli-script">Sometimes, we just want to skip all the errors to quickly write a simple CLI script</h2><p>Using <code>typez.CoalesceX</code>, <code>errorz.Must</code>, <code>errorz.Skip</code>, <code>errorz.Validate</code>, and their variants, we can streamline error handling:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="s">&#34;ezpkg.io/errorz&#34;</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">err</span> <span class="kt">error</span>
    <span class="nx">projectDir</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;PROJECT_DIR&#34;</span><span class="p">)</span>
    <span class="nx">errorz</span><span class="p">.</span><span class="nf">ValidateTof</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">err</span><span class="p">,</span> <span class="nx">projectDir</span> <span class="o">!=</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;no PROJECT_DIR&#34;</span><span class="p">)</span>
    <span class="nx">errorz</span><span class="p">.</span><span class="nf">ValidateTof</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">err</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#34;must at least 1 arg&#34;</span><span class="p">)</span>

    <span class="c1">// panic if any validation fails
</span><span class="c1"></span>    <span class="nx">errorz</span><span class="p">.</span><span class="nf">MustZ</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="c1">// get the file path
</span><span class="c1"></span>    <span class="nx">jsonFile</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">// already check: len(os.Args)&gt;1
</span><span class="c1"></span>
    <span class="c1">// panic if the file extension is not .json
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">!</span><span class="nx">filepath</span><span class="p">.</span><span class="nf">IsAbs</span><span class="p">(</span><span class="nx">jsonFile</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">jsonFile</span> <span class="p">=</span> <span class="nx">filepath</span><span class="p">.</span><span class="nf">Clean</span><span class="p">(</span><span class="nx">filepath</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="nx">projectDir</span><span class="p">,</span> <span class="nx">jsonFile</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="nx">errorz</span><span class="p">.</span><span class="nf">MustValidate</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nf">HasSuffix</span><span class="p">(</span><span class="nx">jsonFile</span><span class="p">,</span> <span class="s">&#34;.json&#34;</span><span class="p">))</span>

    <span class="c1">// read the file, skip error if it does not exist
</span><span class="c1"></span>    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">ReadFile</span><span class="p">(</span><span class="nx">jsonFile</span><span class="p">)</span>

    <span class="c1">// default to empty json object
</span><span class="c1"></span>    <span class="nx">data</span> <span class="p">=</span> <span class="nx">typez</span><span class="p">.</span><span class="nf">CoalesceX</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;{}&#34;</span><span class="p">))</span>

    <span class="c1">// process then print the formatted json
</span><span class="c1"></span>    <span class="nx">object</span> <span class="o">:=</span> <span class="nx">errorz</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nf">process</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
    <span class="nx">formatted</span> <span class="o">:=</span> <span class="nx">errorz</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;\t&#34;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="nx">formatted</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><hr><h2 id="comparing-values-in-tests-with-diff-ignoring-spaces">Comparing values in tests with diff ignoring spaces</h2><p>Another day, we are making some changes to a SQL repository method using <a href="https://pkg.go.dev/gorm.io/gorm">gorm.io/gorm</a> and <a href="https://pkg.go.dev/github.com/golang/mock/gomock">gomock</a>. The test code looks like this:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">var</span> <span class="nx">updateSQL</span> <span class="p">=</span> <span class="s">`UPDATE &#34;company_channels&#34;
</span><span class="s">SET &#34;updated_at&#34;=$1,&#34;access_token&#34;=$2
</span><span class="s">WHERE (&#34;company_id&#34; = $3 AND &#34;channel_code&#34; = $4 AND &#34;channel_type&#34; = $5) AND &#34;company_channels&#34;.&#34;deleted_at&#34; IS NULL`</span>

<span class="nx">dbCtrl</span><span class="p">.</span><span class="nx">SQLMock</span><span class="p">.</span><span class="nf">ExpectExec</span><span class="p">(</span><span class="nx">regexp</span><span class="p">.</span><span class="nf">QuoteMeta</span><span class="p">(</span><span class="nx">updateSQL</span><span class="p">)).</span>
    <span class="nf">WithArgs</span><span class="p">(</span>
        <span class="nx">sqlmock</span><span class="p">.</span><span class="nf">AnyArg</span><span class="p">(),</span>
        <span class="nx">companyChannel</span><span class="p">.</span><span class="nx">AccessToken</span><span class="p">,</span>
        <span class="nx">companyChannel</span><span class="p">.</span><span class="nx">CompanyID</span><span class="p">,</span>
        <span class="nx">companyChannel</span><span class="p">.</span><span class="nx">ChannelCode</span><span class="p">,</span>
        <span class="nx">companyChannel</span><span class="p">.</span><span class="nx">ChannelType</span><span class="p">,</span>
    <span class="p">).</span><span class="nf">WillReturnResult</span><span class="p">(</span><span class="nx">sqlmock</span><span class="p">.</span><span class="nf">NewResult</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div><p>We might encounter this error, which is hard to read and see what is wrong:</p><p><img src="d1.png" alt=""></p><h3 id="import-ezpkgiodiffz">Import &ldquo;ezpkg.io/diffz&rdquo;</h3><p>Rewrite the assertion function:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">diffz</span><span class="p">.</span><span class="nf">IgnoreSpace</span><span class="p">().</span><span class="nf">DiffByChar</span><span class="p">(</span><span class="nx">actualSQL</span><span class="p">,</span> <span class="nx">expectedSQL</span><span class="p">)</span>
</code></pre></div><p>This provides cleaner output and quickly highlights differences:</p><p><img src="d2.png" alt=""></p><h3 id="support-for-tests-with-random-values">Support for tests with random values</h3><p>Using <code>diffz.Placeholder().AndIgnoreSpaces().DiffByLine()</code> or simply <code>diffz.ByLineZ()</code>:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">expect</span> <span class="o">:=</span> <span class="s">`
</span><span class="s">color:
</span><span class="s">  id: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ-â–ˆâ–ˆâ–ˆâ–ˆ-â–ˆâ–ˆâ–ˆâ–ˆ-â–ˆâ–ˆâ–ˆâ–ˆ-â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
</span><span class="s">  name: red
</span><span class="s">  size: small
</span><span class="s">  code: #ff0000`</span>
<span class="nx">red</span> <span class="o">:=</span> <span class="s">`
</span><span class="s">color:
</span><span class="s">  id: d56d5f0d-f05d-4d46-9ce2-af6396d25c55
</span><span class="s">  name: red
</span><span class="s">  size: small
</span><span class="s">  code: #ff0000`</span>
<span class="nx">green</span> <span class="o">:=</span> <span class="s">`
</span><span class="s">color:
</span><span class="s">  id: 5b01ec0b-0607-446e-8a25-aaef595902a9
</span><span class="s">  name: green
</span><span class="s">  size: small
</span><span class="s">  code: #00ff00`</span>

<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;no diff&#34;</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">diffz</span><span class="p">.</span><span class="nf">ByLineZ</span><span class="p">(</span><span class="nx">red</span><span class="p">,</span> <span class="nx">expect</span><span class="p">))</span>

<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;diff&#34;</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">diffz</span><span class="p">.</span><span class="nf">ByLineZ</span><span class="p">(</span><span class="nx">red</span><span class="p">,</span> <span class="nx">green</span><span class="p">))</span>
</code></pre></div><p>The first <code>diffz.ByLineZ(red, expect)</code> will be considered equal, because of the use of placeholder <code>â–ˆ</code>. The second <code>diffz.ByLineZ(red, green)</code> will output:</p><p><img src="d3.png" alt=""></p><hr><h2 id="ezpkgio---collection-of-go-packages">ezpkg.io - Collection of Go packages</h2><p>These packages are created to enhance the functionality of the standard library and other popular packages. They are intended to be used together with other packages rather than replacing them. The APIs are designed based on my experience working with Go, focusing on simplicity and ease of use. I will try to follow best practices in Go, but not always. I also tend to choose a more performance implementation if possible.</p><h3 id="versioning">Versioning</h3><p>All packages are released together with the same version number to simplify management, as they often call each other. When the API evolves, the version number is incremented for all packages.</p><h3 id="why-should-you-not-use-these-packages">Why should you NOT use these packages?</h3><ul><li><strong>More dependencies</strong>: These packages will add more dependencies to your project.</li><li><strong>Early development</strong>: This project is in its early stages and will have API changes. There are other packages that are more mature and offer more features.</li><li><strong>Customization</strong>: Sometimes, writing your own code allows for better customization. You can also copy code from these packages and modify it to fit your specific needs.</li></ul><h3 id="why-should-you-use-these-packages">Why should you use these packages?</h3><ul><li>You find yourself copying the same code over and over.</li><li>You are starting a new project and want some simple and easy-to-use packages.</li><li>You are learning Go and want to see how some common tasks are implemented.</li></ul><h3 id="stay-tuned">Stay Tuned</h3><p>Most packages are usable but the API may change over time. There are a lot of missing utilities that I will add sooner or later. If you need something or want to share your thoughts, feel free to <a href="https://github.com/ezpkg/ezpkg/issues">open an issue</a> or <a href="https://github.com/ezpkg/ezpkg/discussions">start a discussion</a>. I&rsquo;m curious to see if these packages are making life <em>ea<strong>z</strong>ier</em> for you! ðŸ‘‹</p><p>Happy coding! ðŸš€</p><h2 id="author">Author</h2><p>I'm Oliver Nguyen. A software maker working mostly in Go and JavaScript. I enjoy learning and seeing a better version of myself each day. Occasionally spin off new open source projects. Share knowledge and thoughts during my journey. <span>Connect with me on <a class="icon" target="_blank" rel="noopener" href="https://github.com/iOliverNguyen"><i class="fab fa-github"></i> </a>, <a class="icon" target="_blank" rel="noopener" href="https://linkedin.com/in/iOliverNguyen"><i class="fab fa-linkedin"></i> </a>, <a class="icon" target="_blank" rel="noopener" href="https://x.com/_OliverNguyen"><i class="fab fa-twitter"></i> </a>, <a class="icon" target="_blank" rel="noopener" href="https://iOliverNguyen.medium.com"><i class="fab fa-medium-m"></i> </a>and <a class="icon" target="_blank" rel="noopener" href="mailto:iOliverNguyen@gmail.com"><i class="fas fa-envelope"></i> </a>.</span></p></div></article><div id="header-post"><a id="menu-icon" href="/w"><i class="fas fa-chevron-left fa-lg"></i> <span class="icon-text">Back</span></a> <a id="menu-icon-tablet" href="/w"><i class="fas fa-chevron-left fa-lg"></i> <span class="icon-text">Back</span></a></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul></ul></div><div id="toc-footer" class="tog-footer" style="display:none"><script>console.log("content",'<nav id="TableOfContents">\n  <ul>\n    <li><a href="#handling-errors-in-functions-that-always-return-nil-errors">Handling errors in functions that always return nil errors</a>\n      <ul>\n        <li><a href="#import-ezpkgiostringz">Import &ldquo;ezpkg.io/stringz&rdquo;</a></li>\n      </ul>\n    </li>\n    <li><a href="#sometimes-we-just-want-to-skip-all-the-errors-to-quickly-write-a-simple-cli-script">Sometimes, we just want to skip all the errors to quickly write a simple CLI script</a></li>\n    <li><a href="#comparing-values-in-tests-with-diff-ignoring-spaces">Comparing values in tests with diff ignoring spaces</a>\n      <ul>\n        <li><a href="#import-ezpkgiodiffz">Import &ldquo;ezpkg.io/diffz&rdquo;</a></li>\n        <li><a href="#support-for-tests-with-random-values">Support for tests with random values</a></li>\n      </ul>\n    </li>\n    <li><a href="#ezpkgio---collection-of-go-packages">ezpkg.io - Collection of Go packages</a>\n      <ul>\n        <li><a href="#versioning">Versioning</a></li>\n        <li><a href="#why-should-you-not-use-these-packages">Why should you NOT use these packages?</a></li>\n        <li><a href="#why-should-you-use-these-packages">Why should you use these packages?</a></li>\n        <li><a href="#stay-tuned">Stay Tuned</a></li>\n      </ul>\n    </li>\n  </ul>\n</nav>')</script><div class="toc-header"><a href="#">ezpkg.io - Collection of packages to make writing Go code easier</a></div><nav id="TableOfContents"><ul><li><a href="#handling-errors-in-functions-that-always-return-nil-errors">Handling errors in functions that always return nil errors</a><ul><li><a href="#import-ezpkgiostringz">Import &ldquo;ezpkg.io/stringz&rdquo;</a></li></ul></li><li><a href="#sometimes-we-just-want-to-skip-all-the-errors-to-quickly-write-a-simple-cli-script">Sometimes, we just want to skip all the errors to quickly write a simple CLI script</a></li><li><a href="#comparing-values-in-tests-with-diff-ignoring-spaces">Comparing values in tests with diff ignoring spaces</a><ul><li><a href="#import-ezpkgiodiffz">Import &ldquo;ezpkg.io/diffz&rdquo;</a></li><li><a href="#support-for-tests-with-random-values">Support for tests with random values</a></li></ul></li><li><a href="#ezpkgio---collection-of-go-packages">ezpkg.io - Collection of Go packages</a><ul><li><a href="#versioning">Versioning</a></li><li><a href="#why-should-you-not-use-these-packages">Why should you NOT use these packages?</a></li><li><a href="#why-should-you-use-these-packages">Why should you use these packages?</a></li><li><a href="#stay-tuned">Stay Tuned</a></li></ul></li></ul></nav></div><div id="share-footer" class="tog-footer" style="display:none"><ul><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fezpkg%2f&title=ezpkg.io%20-%20Collection%20of%20packages%20to%20make%20writing%20Go%20code%20easier"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fezpkg%2f"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://x.com/share?url=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fezpkg%2f&text=ezpkg.io%20-%20Collection%20of%20packages%20to%20make%20writing%20Go%20code%20easier"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fezpkg%2f&title=ezpkg.io%20-%20Collection%20of%20packages%20to%20make%20writing%20Go%20code%20easier"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fiOliverNguyen.github.io%2fw%2fezpkg%2f&t=ezpkg.io%20-%20Collection%20of%20packages%20to%20make%20writing%20Go%20code%20easier"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="home" class="icon" href="/w"><i class="fas fa-chevron-left fa-lg" aria-hidden="true"></i> Back</a> <a id="toc" class="icon" href="#" onclick='return $(".tog-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $(".tog-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2024 Oliver Nguyen.</div><div class="footer-right"><nav><ul></ul></nav></div></footer></div></body><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script src="/lib/jquery/jquery.min.js"></script><script src="/js/main.js"></script></html>